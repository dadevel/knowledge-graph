---
title: Linux Kernel Privilege Escalation Exploits
---

[[notes/linux/privilege-escalation]] trough kernel exploits.

Get the kernel version.

~~~ bash
uname -a
~~~

List kernel modules.

~~~ bash
lsmod
~~~

Get the version of a kernel module.

~~~ bash
modinfo libata
~~~

Untested tools:

- [linux-exploit-suggester-2](https://github.com/jondonas/linux-exploit-suggester-2), Linux kernel exploit suggester

Exploit collections:

- [github.com/bsauce/kernel-exploit-factory](https://github.com/bsauce/kernel-exploit-factory)
- [github.com/xairy/linux-kernel-exploitation](https://github.com/xairy/linux-kernel-exploitation#exploits)
- [fareedfauzi.gitbook.io/oscp-playbook/linux-post-exploitation/linux-exploitation](http://web.archive.org/web/20230523122537/https://fareedfauzi.gitbook.io/oscp-playbook/linux-post-exploitation/linux-exploitation)

References:

- [LiKE: A Series on Linux kernel exploitation](https://sam4k.com/like-a-series-on-linux-kernel-exploitation/)

# Compiling Exploits

Get the distro and `libc` version of the target.

~~~ bash
cat /etc/os-release
ldd --version
~~~

Compile an exploit and include the `libc` of your host.

~~~ bash
gcc -o ./pwn ./pwn.c -static
gcc -o ./pwn ./pwn.c -m32 -Wl,--hash-style=both -static
~~~

If the statically compiled exploit does not work, compile the exploit in a Docker container matching the distro version instead.

# CVE-2009-2698 in ip_append_data()

Affects 2.6 < 2.6.19 (32bit).

# CVE-2017-16995 in BPF

Affects 4.4.0
Successfully exploited with [github.com/gugronnier/cve-2017-16995](http://web.archive.org/web/20230530115947/https://raw.githubusercontent.com/gugronnier/CVE-2017-16995/master/exploit-poc-pentest.c).

# DirtyCow CVE-2016-5195

Affects 2.6.22 < 3.9.
Successfully exploited with [gist.github.com/rverton/e9d4ff65d703a9084e85fa9df083c679](http://web.archive.org/web/20180826162437/https://gist.githubusercontent.com/rverton/e9d4ff65d703a9084e85fa9df083c679/raw/9b1b5053e72a58b40b28d6799cf7979c53480715/cowroot.c)

# CVE-2010-3904 in RDS Protocol

Affects kernels from at least 2.6.32 up to 2.6.36-rc8.
Successfully exploited with [exploit-db.com/exploits/15285](http://web.archive.org/web/20210927124552/https://www.exploit-db.com/download/15285) on Ubuntu 10.04 kernel 2.6.32-21.

# Heap Overflow in legacy_parse_param CVE-2022-0185

Affects 5.1-rc1 up to 5.16.0.
Also functions as container escape.
Successfully exploited with [github.com/crusaders-of-rust/cve-2022-0185](https://github.com/Crusaders-of-Rust/CVE-2022-0185).

# Dirty Pipe

Vulnerable since 5.8, fixed since 5.10.102 / 5.15.25 / 5.16.11.

Untested exploits:

- [dirtypipez.c](http://web.archive.org/web/20221006110338/https://haxx.in/files/dirtypipez.c)

References:

- [The Dirty Pipe Vulnerability](http://web.archive.org/web/20220901161644/https://dirtypipe.cm4all.com/)

# CVE-2022-23222

Vulnerable since 5.8, fixed since 5.10.92 / 5.15.15 / 5.16.1.

Untested exploits:

- [github.com/tr3ee/cve-2022-23222](https://github.com/tr3ee/CVE-2022-23222)

References:

- <https://www.openwall.com/lists/oss-security/2022/01/13/1>

# SUID Binaries on OverlayFS CVE-2023-0386

Untested exploits:

- [github.com/xkaneiki/cve-2023-0386](https://github.com/xkaneiki/CVE-2023-0386)

References:

- [PoC Exploit Released for Linux Kernel Privilege Escalation (CVE-2023-0386) Bug](http://web.archive.org/web/20230505111920/https://securityonline.info/poc-exploit-released-for-linux-kernel-privilege-escalation-cve-2023-0386-bug/)

# StackRot CVE-2023-3269

Affects Linux 6.1 through 6.4.

Untested exploits:

- [github.com/lrh2000/stackrot](https://github.com/lrh2000/StackRot)
