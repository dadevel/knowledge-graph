---
title: M365 Post Exploitation
---

When you have a refresh token for one of Microsofts cloud apps, e.g. from device code phishing or dumped from a client, you can [[notes/entra/foci|*refresh into* other apps]].

Applications:

- [[notes/m365/exchange]]
- [[notes/m365/teams]]
- [[notes/m365/onedrive]]
- [[notes/m365/sharepoint]]
- [[notes/m365/power-platform]]

Basic discovery with [[notes/tools/aadinternals]].

~~~
Get-AADIntAccessTokenForAzureCoreManagement -SaveToCache
$results = Invoke-AADIntReconAsInsider
$results | gm
~~~

References:

- [Fact Based Post Exploitation Office365 Edition - TROOPERS23](https://www.youtube.com/watch?v=QqcRe-8tc7A)
- [Hacking Your Cloud: Tokens Edition 2.0](http://web.archive.org/web/20230414061723/https://www.trustedsec.com/blog/hacking-your-cloud-tokens-edition-2-0/)
